<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CraftCraftMine | Status</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="status-config.js"></script>
    <style>
        body { background-color: #0a0f1e; color: #f1f5f9; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(30, 41, 59, 0.5); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.08); }
        .bar-container { display: flex; gap: 3px; height: 32px; align-items: flex-end; }
        .bar { flex-grow: 1; height: 100%; border-radius: 2px; cursor: pointer; transition: all 0.2s ease; }
        .bar-green { background-color: #10b981; opacity: 0.6; }
        .bar-red { background-color: #ef4444; opacity: 1; box-shadow: 0 0 12px rgba(239,68,68,0.4); }
        .bar:hover { transform: scaleY(1.2); opacity: 1; }
        .detail-box { display: none; margin-top: 15px; font-size: 12px; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-10">
            <a href="https://craftcraftmine.net" class="glass px-5 py-2 rounded-xl text-[10px] font-black text-red-500 uppercase tracking-widest hover:bg-red-500/10 transition border border-red-500/20">
                ← PORTAL
            </a>
            <div class="text-[10px] font-bold text-gray-500 tracking-widest uppercase italic">System-Protokoll V2.7</div>
        </header>

        <div id="status-banner" class="rounded-[1.5rem] p-6 mb-12 flex items-center gap-6 shadow-2xl transition-all border-l-8">
            <div id="status-icon" class="w-12 h-12 rounded-full flex items-center justify-center text-2xl animate-pulse"></div>
            <div>
                <h2 class="text-xs font-black uppercase tracking-[0.2em] opacity-60 mb-1">Aktueller Systemstatus</h2>
                <p id="status-text" class="text-lg font-bold italic tracking-tight"></p>
            </div>
        </div>

        <div class="space-y-6">
            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-green-500/30">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="font-black uppercase tracking-widest text-sm text-green-400">Minecraft Netzwerk</h3>
                        <p class="text-[9px] text-gray-500 uppercase mt-1">Haupt-Server Instanz</p>
                    </div>
                    <span id="java-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="java-bars"></div>
                <div id="java-details" class="detail-box glass p-4 rounded-xl border border-green-500/20 mt-2"></div>
            </div>

            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-red-500/30">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="font-black uppercase tracking-widest text-sm text-red-500">Web-Portal</h3>
                        <p class="text-[9px] text-gray-500 uppercase mt-1">Hauptwebsite & News</p>
                    </div>
                    <span id="web-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="web-bars"></div>
                <div id="web-details" class="detail-box glass p-4 rounded-xl border border-red-500/20 mt-2"></div>
            </div>

            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-blue-500/30">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="font-black uppercase tracking-widest text-sm text-blue-400">PlayerPortal</h3>
                        <p class="text-[9px] text-gray-500 uppercase mt-1">Spieler-Statistiken & Login</p>
                    </div>
                    <span id="player-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="player-bars"></div>
                <div id="player-details" class="detail-box glass p-4 rounded-xl border border-blue-500/20 mt-2"></div>
            </div>

            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-white/20">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="font-black uppercase tracking-widest text-sm text-gray-300">Domain Routing</h3>
                        <p class="text-[9px] text-gray-500 uppercase mt-1">DNS: craftcraftmine.net</p>
                    </div>
                    <span id="domain-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="domain-bars"></div>
                <div id="domain-details" class="detail-box glass p-4 rounded-xl border border-white/10 mt-2"></div>
            </div>
        </div>

        <footer class="mt-16 flex flex-col md:flex-row justify-between items-center gap-6 opacity-40 pb-10">
            <div class="text-[9px] font-bold tracking-widest uppercase text-center md:text-left leading-loose">
                © 2026 CraftCraftMine Netzwerk
            </div>
            <div class="text-[9px] font-mono bg-white/5 px-4 py-2 rounded-full border border-white/5" id="sync-time">
                LAST SYNC: --:--:--
            </div>
        </footer>
    </div>

    <script>
        // Initialisiere Banner aus Config
        function initBanner() {
            const banner = document.getElementById('status-banner');
            const icon = document.getElementById('status-icon');
            const text = document.getElementById('status-text');
            const type = STATUS_CONFIG.globalStatus.type;

            const styles = {
                online: { color: 'green', char: '✓' },
                warning: { color: 'orange', char: '!' },
                critical: { color: 'red', char: '✕' }
            }[type] || { color: 'gray', char: '?' };

            banner.className += ` bg-${styles.color}-500/10 border-${styles.color}-500 text-${styles.color}-400`;
            icon.className += ` bg-${styles.color}-500/20`;
            icon.innerText = styles.char;
            text.innerText = STATUS_CONFIG.globalStatus.message;
        }

        async function updateMonitor(key, prefix) {
            if (!key || key.includes('KEY_')) return;
            try {
                const response = await fetch(`https://api.uptimerobot.com/v2/getMonitors`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `api_key=${key}&format=json&custom_uptime_ratios=1&logs=1`
                });
                const data = await response.json();
                const monitor = data.monitors[0];
                const logs = monitor.logs || [];

                const isOnline = monitor.status === 2;
                const label = document.getElementById(`${prefix}-label`);
                const container = document.getElementById(`${prefix}-bars`);

                label.innerText = isOnline ? 'STABIL' : 'STÖRUNG';
                label.className = `text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 ${isOnline ? 'text-green-400' : 'text-red-500 animate-pulse'}`;

                container.innerHTML = '';
                for(let i=0; i < 35; i++) {
                    const bar = document.createElement('div');
                    const barTime = new Date(new Date().getTime() - ((34 - i) * 40 * 60000));
                    const wasDown = logs.some(log => log.type === 1 && Math.abs(new Date(log.datetime * 1000) - barTime) < (40 * 60000));

                    bar.className = `bar ${wasDown ? 'bar-red' : 'bar-green'}`;
                    bar.onclick = (e) => {
                        e.stopPropagation();
                        document.querySelectorAll('.detail-box').forEach(el => el.style.display = 'none');
                        const detail = document.getElementById(`${prefix}-details`);
                        detail.style.display = 'block';
                        detail.innerHTML = `
                            <div class="flex justify-between mb-1 ${wasDown ? 'text-red-500' : 'text-green-400'} font-bold uppercase text-[9px]">
                                <span>${wasDown ? 'Störung' : 'Stabil'}</span>
                                <span>${barTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} Uhr</span>
                            </div>
                            <p class="text-gray-400 italic text-[10px]">${wasDown ? 'Verbindung unterbrochen.' : 'System vollständig operational.'}</p>
                        `;
                    };
                    container.appendChild(bar);
                }
            } catch(e) { console.error("Error fetching", prefix); }
        }

        function startSync() {
            const keys = STATUS_CONFIG.monitors;
            updateMonitor(keys.java, 'java');
            updateMonitor(keys.web, 'web');
            updateMonitor(keys.player, 'player');
            updateMonitor(keys.domain, 'domain');
            document.getElementById('sync-time').innerText = `LAST SYNC: ${new Date().toLocaleTimeString()}`;
        }

        document.addEventListener('click', () => {
            document.querySelectorAll('.detail-box').forEach(el => el.style.display = 'none');
        });

        initBanner();
        startSync();
        setInterval(startSync, 120000);
    </script>
</body>
</html>
