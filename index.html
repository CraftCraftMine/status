<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CraftCraftMine | Status</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0a0f1e; color: #f1f5f9; font-family: 'Inter', sans-serif; }
        .glass { background: rgba(30, 41, 59, 0.5); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.08); }
        .bar-container { display: flex; gap: 3px; height: 32px; align-items: flex-end; }
        .bar { flex-grow: 1; height: 100%; border-radius: 2px; cursor: pointer; transition: all 0.2s ease; }
        .bar-green { background-color: #10b981; opacity: 0.6; }
        .bar-red { background-color: #ef4444; opacity: 1; box-shadow: 0 0 12px rgba(239,68,68,0.4); }
        .bar:hover { transform: scaleY(1.2); opacity: 1; }
        .detail-box { display: none; margin-top: 15px; font-size: 12px; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-10">
            <a href="https://craftcraftmine.net" class="glass px-5 py-2 rounded-xl text-[10px] font-black text-red-500 uppercase tracking-widest hover:bg-red-500/10 transition border border-red-500/20">
                ← PORTAL
            </a>
            <div class="text-[10px] font-bold text-gray-500 tracking-widest uppercase italic">System-Protokoll V2.2</div>
        </header>

        <div class="text-center mb-12">
            <h1 class="text-4xl font-black uppercase tracking-tighter italic">CRAFTCRAFT<span class="text-red-600">MINE</span></h1>
            <p class="text-gray-500 text-[10px] font-bold tracking-[0.4em] uppercase mt-2">Infrastruktur Status</p>
        </div>

        <div class="space-y-6">
            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-green-500/30">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="font-black uppercase tracking-widest text-sm">Java Edition (Main)</h3>
                        <p class="text-[9px] text-gray-500 uppercase mt-1">Primärer Spiel-Server</p>
                    </div>
                    <span id="java-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="java-bars"></div>
                <div class="flex justify-between mt-3 text-[9px] font-bold text-gray-600 uppercase">
                    <span id="java-uptime">--% Uptime</span>
                    <span>24h Protokoll</span>
                </div>
                <div id="java-details" class="detail-box glass p-4 rounded-xl border border-green-500/20 mt-2"></div>
            </div>

            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-blue-500/30">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="font-black uppercase tracking-widest text-sm text-blue-400">Bedrock Support</h3>
                        <p class="text-[9px] text-gray-500 uppercase mt-1">Geyser Proxy-Schnittstelle</p>
                    </div>
                    <span id="bedrock-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="bedrock-bars"></div>
                <div class="flex justify-between mt-3 text-[9px] font-bold text-gray-600 uppercase">
                    <span id="bedrock-uptime">--% Uptime</span>
                    <span>Geyser Status</span>
                </div>
                <div id="bedrock-details" class="detail-box glass p-4 rounded-xl border border-blue-500/20 mt-2"></div>
            </div>

            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-red-500/30">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-black uppercase tracking-widest text-xs text-red-500">Hauptwebsite (GitHub)</h3>
                    <span id="web-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="web-bars"></div>
                <div id="web-details" class="detail-box glass p-4 rounded-xl border border-red-500/20 mt-2"></div>
            </div>

            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-white/20">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-black uppercase tracking-widest text-xs text-gray-300">Domain-Routing (IONOS)</h3>
                    <span id="domain-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="domain-bars"></div>
                <div id="domain-details" class="detail-box glass p-4 rounded-xl border border-white/10 mt-2"></div>
            </div>

            <div class="glass rounded-[1.5rem] p-6 border-t-2 border-orange-500/30">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-black uppercase tracking-widest text-xs text-orange-400">Live Map</h3>
                    <span id="map-label" class="text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 uppercase">Lädt...</span>
                </div>
                <div class="bar-container" id="map-bars"></div>
                <div id="map-details" class="detail-box glass p-4 rounded-xl border border-orange-500/20 mt-2"></div>
            </div>
        </div>

        <footer class="mt-16 flex flex-col md:flex-row justify-between items-center gap-6 opacity-40">
            <div class="text-[9px] font-bold tracking-widest uppercase text-center md:text-left">
                © 2026 CraftCraftMine Netzwerk
            </div>
            <div class="text-[9px] font-mono bg-white/5 px-4 py-2 rounded-full border border-white/5" id="sync-time">
                LAST SYNC: --:--:--
            </div>
        </footer>
    </div>

    <script>
        const MONITORS = {
            java:    'm802228348-28e6cbe112134f661ce9d6ac',
            bedrock: 'm802228476-be66200d8ca51bde00fb9973',
            web:     'DEIN_KEY_WEBSITE',
            domain:  'DEIN_KEY_DOMAIN',
            map:     'DEIN_KEY_MAP'
        };

        function closeDetails() {
            document.querySelectorAll('.detail-box').forEach(el => el.style.display = 'none');
        }

        async function updateMonitor(key, prefix) {
            if (!key || key.includes('DEIN_')) return;
            try {
                const response = await fetch(`https://api.uptimerobot.com/v2/getMonitors`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `api_key=${key}&format=json&custom_uptime_ratios=1&logs=1`
                });
                const data = await response.json();
                const monitor = data.monitors[0];
                const logs = monitor.logs || [];

                const isOnline = monitor.status === 2;
                const label = document.getElementById(`${prefix}-label`);
                const uptime = document.getElementById(`${prefix}-uptime`);
                const container = document.getElementById(`${prefix}-bars`);

                label.innerText = isOnline ? 'STABIL' : 'STÖRUNG';
                label.className = `text-[9px] font-black py-1 px-3 rounded-full bg-gray-900 border border-white/5 ${isOnline ? 'text-green-400' : 'text-red-500 animate-pulse'}`;
                if(uptime) uptime.innerText = `${monitor.custom_uptime_ratio}% UPTIME`;

                container.innerHTML = '';
                const totalBars = 35; 
                const now = new Date();

                for(let i=0; i < totalBars; i++) {
                    const bar = document.createElement('div');
                    const minutesBack = (totalBars - 1 - i) * 40; 
                    const barTime = new Date(now.getTime() - (minutesBack * 60000));
                    
                    const wasDown = logs.some(log => {
                        const logTime = new Date(log.datetime * 1000);
                        return log.type === 1 && Math.abs(logTime - barTime) < (40 * 60000);
                    });

                    bar.className = `bar ${wasDown ? 'bar-red' : 'bar-green'}`;
                    
                    bar.onclick = (e) => {
                        e.stopPropagation();
                        closeDetails();
                        const detail = document.getElementById(`${prefix}-details`);
                        detail.style.display = 'block';
                        
                        // GRÜNE Meldung bei Stabilität, ROTE bei Störung
                        const statusColor = wasDown ? 'text-red-500' : 'text-green-400';
                        const statusTitle = wasDown ? 'Störung erkannt' : 'System stabil';
                        const statusDesc = wasDown ? 'Verbindung zum Host wurde unterbrochen.' : 'Keine Unregelmäßigkeiten im Zeitraum erkannt.';

                        detail.innerHTML = `
                            <div class="flex justify-between mb-1 ${statusColor} font-bold uppercase text-[9px]">
                                <span>${statusTitle}</span>
                                <span>${barTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} Uhr</span>
                            </div>
                            <p class="text-gray-400 italic">${statusDesc}</p>
                        `;
                    };
                    container.appendChild(bar);
                }
            } catch(e) { console.error("Error", prefix); }
        }

        function startSync() {
            Object.keys(MONITORS).forEach(id => updateMonitor(MONITORS[id], id));
            document.getElementById('sync-time').innerText = `LAST SYNC: ${new Date().toLocaleTimeString()}`;
        }

        document.addEventListener('click', closeDetails);
        startSync();
        setInterval(startSync, 120000);
    </script>
</body>
</html>
